name: cert-manager
type: helm
enabled: true
namespace: cert-manager
chart: jetstack/cert-manager
values:
  crds.enabled: true
hooks:
  preInstall:
    - "helm repo add jetstack https://charts.jetstack.io"
    - "helm repo update"
    - "kubectl create namespace cert-manager --dry-run=client -o yaml | kubectl apply -f -"
  postInstall:
    - "kubectl wait --for=condition=Available deployment/cert-manager -n cert-manager --timeout=120s"
  preUpgrade:
    - "kubectl get issuers,clusterissuers,certificates --all-namespaces -o yaml > cert-manager-backup.yaml"
    - "helm repo update"
  postUpgrade:
    - "kubectl wait --for=condition=Available deployment/cert-manager -n cert-manager --timeout=120s"
